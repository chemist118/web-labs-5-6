{"remainingRequest":"C:\\Users\\otino\\Desktop\\WEB56\\Client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\otino\\Desktop\\WEB56\\Client\\src\\components\\views\\LoginPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\otino\\Desktop\\WEB56\\Client\\src\\components\\views\\LoginPage.vue","mtime":1575643814000},{"path":"C:\\Users\\otino\\Desktop\\WEB56\\Client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\otino\\Desktop\\WEB56\\Client\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\otino\\Desktop\\WEB56\\Client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\otino\\Desktop\\WEB56\\Client\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCgpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAnTG9naW4nLAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBsb2dpbjogJycsCiAgICAgICAgICAgIHBhc3N3b3JkOiAnJywKICAgICAgICAgICAgZGlzbWlzc1NlY3M6IDQsCiAgICAgICAgICAgIGRpc21pc3NDb3VudERvd246IDAKICAgICAgICB9CiAgICB9LAogICAgY29tcHV0ZWQ6IHsKICAgICAgICBnZXRVc2VyKCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVycy51c2VyOwogICAgICAgIH0sCiAgICAgICAgZ2V0RXJyb3IoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzLmxvZ2luRXJyb3I7CiAgICAgICAgfQogICAgfSwKICAgIGFzeW5jIGNyZWF0ZWQoKSB7CiAgICAgICAgaWYgKHRoaXMuZ2V0RXJyb3IgIT09IG51bGwgKSB7CiAgICAgICAgICAgIHRoaXMuc2hvd0FsZXJ0KCk7CiAgICAgICAgICAgIGF3YWl0IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ1NFVF9FUlJPUicsIHt0eXBlOiAnbG9naW4nLCBlcnJvcjogbnVsbH0pOwogICAgICAgICAgICB9LmJpbmQodGhpcyksIDUwMDApOwogICAgICAgIH0KICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgY291bnREb3duQ2hhbmdlZChkaXNtaXNzQ291bnREb3duKSB7CiAgICAgICAgICAgIHRoaXMuZGlzbWlzc0NvdW50RG93biA9IGRpc21pc3NDb3VudERvd24KICAgICAgICB9LAogICAgICAgIHNob3dBbGVydCgpIHsKICAgICAgICAgICAgdGhpcy5kaXNtaXNzQ291bnREb3duID0gdGhpcy5kaXNtaXNzU2VjcwogICAgICAgIH0sCiAgICAgICAgYXN5bmMgb25TdWJtaXQoKSB7CiAgICAgICAgICAgIGxldCBsb2dpbiA9IHRoaXMubG9naW4gPT09IHVuZGVmaW5lZCA/ICcnIDogdGhpcy5sb2dpbi50cmltKCk7CiAgICAgICAgICAgIGxldCBwYXNzd29yZCA9IHRoaXMucGFzc3dvcmQgPT09IHVuZGVmaW5lZCA/ICcnIDogdGhpcy5wYXNzd29yZC50cmltKCk7CgogICAgICAgICAgICBhd2FpdCBmZXRjaChgL2FwaS9sb2dpbj91c2VyX2xvZ2luPSR7bG9naW59JnVzZXJfcGFzc3dvcmQ9JHtwYXNzd29yZH1gLCB7CiAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmpzb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oanNvbiA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ1NFVF9FUlJPUicsIHt0eXBlOiAnbG9naW4nLCBlcnJvcjogbnVsbH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdTRVRfVVNFUicsIEpTT04ucGFyc2UoanNvbikpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5pZCA9IHRoaXMuZ2V0VXNlci5pZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UubG9naW4gPSB0aGlzLmdldFVzZXIubG9naW47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goe3BhdGg6ICcvaG9tZSd9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmpzb24oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oanNvbiA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ1NFVF9FUlJPUicsIHt0eXBlOiAnbG9naW4nLCBlcnJvcjoganNvbi5lcnJvcn0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0FsZXJ0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnU0VUX0VSUk9SJywge3R5cGU6ICdsb2dpbicsIGVycm9yOiBlcnJvcn0pOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0FsZXJ0KCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9Cn0K"},{"version":3,"sources":["LoginPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LoginPage.vue","sourceRoot":"src/components/views","sourcesContent":["<template>\n    <div class=\"container\">\n        <section class=\"card card-default w-50 mx-auto\">\n            <h4 class=\"card-header alert-info text-center\">Login</h4>\n\n            <form class=\"card-body\" @submit.prevent=\"onSubmit\">\n                <b-alert variant=\"danger\"\n                         :show=\"dismissCountDown\"\n\t\t\t\t\t\t dismissible fade\n                         @dismiss-count-down=\"countDownChanged\">\n                    {{ getError }}\n                </b-alert>\n\n                <div class=\"form-group\">\n                    <label for=\"login-input\">Username:</label>\n                    <input type=\"text\" name=\"login\" class=\"form-control\" id=\"login-input\" placeholder=\"Username\"\n                           v-model=\"login\">\n                </div>\n                <div class=\"form-group\">\n                    <label for=\"password-input\">Password:</label>\n                    <input type=\"password\" name=\"password\" class=\"form-control\" id=\"password-input\" placeholder=\"******\"\n                           v-model=\"password\">\n                </div>\n                <button type=\"submit\" class=\"btn btn-primary text-center\">Login to account</button>\n            </form>\n        </section>\n    </div>\n</template>\n\n\n<script>\n\n    export default {\n        name: 'Login',\n        data() {\n            return {\n                login: '',\n                password: '',\n                dismissSecs: 4,\n                dismissCountDown: 0\n            }\n        },\n        computed: {\n            getUser() {\n                return this.$store.getters.user;\n            },\n            getError() {\n                return this.$store.getters.loginError;\n            }\n        },\n        async created() {\n            if (this.getError !== null ) {\n                this.showAlert();\n                await setTimeout(function () {\n                    this.$store.dispatch('SET_ERROR', {type: 'login', error: null});\n                }.bind(this), 5000);\n            }\n        },\n        methods: {\n            countDownChanged(dismissCountDown) {\n                this.dismissCountDown = dismissCountDown\n            },\n            showAlert() {\n                this.dismissCountDown = this.dismissSecs\n            },\n            async onSubmit() {\n                let login = this.login === undefined ? '' : this.login.trim();\n                let password = this.password === undefined ? '' : this.password.trim();\n\n                await fetch(`/api/login?user_login=${login}&user_password=${password}`, {\n                    method: 'GET'\n                })\n                    .then(response => {\n                        if (response.status === 200) {\n                            response.json()\n                                .then(json => {\n                                    this.$store.dispatch('SET_ERROR', {type: 'login', error: null});\n                                    this.$store.dispatch('SET_USER', JSON.parse(json));\n                                    localStorage.id = this.getUser.id;\n                                    localStorage.login = this.getUser.login;\n                                    this.$router.push({path: '/home'});\n                                });\n                        } else {\n                            response.json()\n                                .then(json => {\n                                    this.$store.dispatch('SET_ERROR', {type: 'login', error: json.error});\n                                    this.showAlert();\n                                });\n                        }\n                    })\n                    .catch(error => {\n                        this.$store.dispatch('SET_ERROR', {type: 'login', error: error});\n                        this.showAlert();\n                    });\n            }\n        }\n    }\n</script>\n\n<style>\n\n    label {\n        float: left;\n    }\n\n    .container {\n        min-height: calc(700px - 5vh - 3rem);\n        height: calc(100% - 12.5rem - 5vh);\n        max-width: calc(100% - 40vw);\n    }\n\n</style>"]}]}